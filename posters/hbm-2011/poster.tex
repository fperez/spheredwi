%\documentclass[landscape,a0b,final,a4resizeable]{a0poster}
\documentclass[landscape,a0b,final]{a0poster}
%\documentclass[portrait,a0b,final,a4resizeable]{a0poster}
%\documentclass[portrait,a0b,final]{a0poster}
%%% Option "a4resizeable" makes it possible to resize the
%   poster by the command: psresize -pa4 poster.ps poster-a4.ps
%   For final printing, please remove option "a4resizeable" !!


\usepackage{amsthm}
\usepackage{amsbsy}
\usepackage{amssymb}
\usepackage{epsfig}
\usepackage{multicol}
\usepackage{pstricks,pst-grad}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Definition of some variables and colors
%\renewcommand{\rho}{\varrho}
%\renewcommand{\phi}{\varphi}
\setlength{\columnsep}{3cm}
\setlength{\columnseprule}{2mm}
\setlength{\parindent}{0.0cm}

\newtheorem{thm}{Theorem}

\newcommand{\Har}{{\mathcal H}}

\newcommand{\HH}{{\mathcal P}}

\newcommand{\Qu}{{\mathbb H}}

\newcommand{\bomega}{{\boldsymbol{\omega}}}

\newcommand{\odotop}{{\boldsymbol{\omega}\cdot\boldsymbol{\omega}'}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%               Background                     %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\background}[3]{
  \newrgbcolor{cgradbegin}{#1}
  \newrgbcolor{cgradend}{#2}
  \psframe[fillstyle=gradient,gradend=cgradend,
  gradbegin=cgradbegin,gradmidpoint=#3](0.,0.)(1.\textwidth,-1.\textheight)
}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%                Poster                        %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newenvironment{poster}{
  \begin{center}
  \begin{minipage}[c]{0.98\textwidth}
}{
  \end{minipage} 
  \end{center}
}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%                pcolumn                       %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newenvironment{pcolumn}[1]{
  \begin{minipage}{#1\textwidth}
  \begin{center}
}{
  \end{center}
  \end{minipage}
}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%                pbox                          %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newrgbcolor{lcolor}{0. 0. 0.80}
\newrgbcolor{gcolor1}{1. 1. 1.}
\newrgbcolor{gcolor2}{.80 .80 1.}

\newcommand{\pbox}[4]{
\psshadowbox[#3]{
\begin{minipage}[t][#2][t]{#1}
#4
\end{minipage}
}}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%                myfig                         %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \myfig - replacement for \figure
% necessary, since in multicol-environment 
% \figure won't work

\newcommand{\myfig}[3][0]{
\begin{center}
  \vspace{1.25cm}
  \includegraphics[width=#3\hsize,angle=#1]{#2}
  \nobreak\medskip
\end{center}}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%                mycaption                     %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \mycaption - replacement for \caption
% necessary, since in multicol-environment \figure and
% therefore \caption won't work

%\newcounter{figure}
\setcounter{figure}{1}
\newcommand{\mycaption}[1]{
  \vspace{0.25cm}
  \begin{quote}
    {{\sc Figure} \arabic{figure}: #1}
  \end{quote}
  \vspace{0.25cm}
  \stepcounter{figure}
}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Begin of Document
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

\background{1. 1. 1.}{1. 1. 1.}{0.5}

\vspace*{2cm}


\newrgbcolor{lightblue}{0. 0. 0.80}
\newrgbcolor{white}{1. 1. 1.}
\newrgbcolor{whiteblue}{.80 .80 1.}


\begin{poster}

%%%%%%%%%%%%%%%%%%%%%
%%% Header
%%%%%%%%%%%%%%%%%%%%%
\begin{center}
\begin{pcolumn}{0.98}

\pbox{0.95\textwidth}{}{linewidth=2mm,framearc=0.3,linecolor=lightblue,fillstyle=gradient,gradangle=0,gradbegin=white,gradend=whiteblue,gradmidpoint=1.0,framesep=1em}{

%%% Pic1
\begin{minipage}[c][9cm][c]{0.1\textwidth}
  \begin{flushleft}
    \myfig[0]{UCBerkeleyLogo.eps}{0.9}
  \end{flushleft}
\end{minipage}
%%% Title
\begin{minipage}[c][9cm][c]{0.78\textwidth}
  \begin{center}
    {\sc \Huge Alternate grids for diffusion weighted imaging \\ [7mm] and associated
reconstruction algorithms}\\ [5mm]
    {\Large Fernando Perez and St\'{e}fan van der Walt\\
    University of California Berkeley, Berkeley CA \\[5mm]
    Cory Ahrens\\
    Colorado School of Mines, Golden CO}
  \end{center}
\end{minipage}
%%% Pic2
\begin{minipage}[c][9cm][c]{0.1\textwidth}
  \begin{flushleft}
    \myfig[0]{CSM_Logo.eps}{0.9}
  \end{flushleft}
\end{minipage}

}
\end{pcolumn}
\end{center}


\vspace*{1cm}


%%% Begin of Multicols-Enviroment
\begin{multicols}{3}


%%% Introduction --- new header/section
\begin{center}\pbox{0.8\columnwidth}{}{linewidth=2mm,framearc=0.1,linecolor=lightblue,fillstyle=gradient,gradangle=0,gradbegin=white,gradend=whiteblue,gradmidpoint=1.0,framesep=1em}{\begin{center}Introduction\end{center}}\end{center}
\vspace{0.25cm}
We develop a systematic numerical approach for constructing
nearly optimal quadratures invariant under the icosahedral group to
integrate rotationally invariant subspaces of $L^{2}\left(\mathbb{S}^{2}\right)$
up to a fixed order and degree. Using these grids and a reproducing
kernel, we show how to replace the standard basis of spherical harmonics
by a representation formed using a single function centered at the
quadrature nodes. The reproducing kernel is mostly concentrated near 
the corresponding grid point. In this representation, the 
coefficients, up to a factor, are the values on the grid of the function 
being represented. We may interpret this construction as an analogue of 
Lagrange interpolation on the sphere. 

We view our approach as the first step in constructing a local and
multiresolution representation of functions on the sphere that respects
rotationally invariant subspaces.  


%%% Preliminaries  --- new header/section
\vspace{0.25cm}
\begin{center}\pbox{0.8\columnwidth}{}{linewidth=2mm,framearc=0.1,linecolor=lightblue,fillstyle=gradient,gradangle=0,gradbegin=white,gradend=whiteblue,gradmidpoint=1.0,framesep=1em}{\begin{center}Preliminaries\end{center}}\end{center}
\vspace{0.25cm}

Here we establish notation and state some results about spherical harmonics, reproducing kernels for subspaces of spherical harmonics, the Funk-Radon transform and the Funk-Hecke theorem.

We denote the unit sphere in $\mathbb{R}^{3}$ as $\mathbb{S}^{2}$. An orthonormal basis for $L^{2}\left(\mathbb{S}^{2}\right)$ is given by the spherical harmonics, 
\begin{equation}
  Y_{n}^{m}\left(\theta,\phi\right)=\frac{1}{\sqrt{2\pi}}\overline{P}_{n}^{m}\left(\cos\theta\right)e^{im\phi},\;0\le|m|\le n,\quad n=0,1,\dots,
  \label{eq:ylm}
\end{equation}
%
where the polar angle $\theta\in[0,\pi]$, the azimuthal angle $\phi\in[0,2\pi)$
and $\overline{P}_{n}^{m}$ are the normalized associated Legendre functions. We define a subspace of spherical harmonics with fixed maximum degree $N$ as $\HH_{N}=\mathrm{span}\left\{ Y_{n}^{m}\left(\theta,\phi\right),\:|m|\le n,\:0\le n\le N\right\}$, which has dimension $\left(N+1\right)^{2}$. The reproducing kernel for $\HH_{N}$, 
%
\begin{equation}
  K\left(\bomega\cdot\bomega'\right) = \sum_{n=0}^{N}\frac{2n+1}{4\pi}P_{n}\left(\odotop\right),
  \label{eq:kernel}
\end{equation}
%
satisfies 
%
\begin{equation}
  f\left(\bomega\right)=\int_{\mathbb{S}^{2}}K\left(\odotop\right)f\left(\bomega'\right)d\Omega',\,\,\,\, f\in\HH_{N}.         
  \label{eq:rep}
\end{equation}
%
The identity in (\ref{eq:rep}) may be verified by using the addition theorem for spherical harmonics.
We rely on (\ref{eq:rep}) to develop a localized representation of functions
in $\HH_{N}$ which is an analogue of Lagrange interpolation on the sphere, known as hyper-interpolation.
%
The Funk-Radon transform is the spherical analog of the Radon transform and is defined for functions on the sphere by
%
\begin{equation}
  \mathcal{G}\left[f\right]\left(\mathbf{u}\right)=\int_{\mathbb{S}^{2}} \delta\left(\mathbf{u}\cdot\mathbf{v}\right)f\left(\mathbf{v}\right)d\mathbf{v},         
  \label{eq:funk-radon}
\end{equation}
%
where $\delta$ is the Dirac mass and effectively restricts the integration to be over the equator defined by the intersection of $\mathbb{S}^2$ and the plane $\mathbf{u}\cdot\mathbf{v} = 0$. The last result we will need is the Funk-Hecke theorem, which states that for any continuous function $f\left(t\right)$ on $\left[-1,1\right]$ and any spherical harmonic $Y_n^m$
%
\begin{equation}
  \int_{\mathbb{S}^{2}} f\left(\mathbf{u}\cdot\mathbf{v}\right)Y_n^m\left(\mathbf{v}\right)d\mathbf{v} = \lambda_n Y_n^m\left(\mathbf{u}\right),         
  \label{eq:funk-hecke}
\end{equation}
%
where $\lambda_n = 2\pi \int_{-1}^{1} f\left(t\right)P_n\left(t\right)dt$ and $P_n$ is the $n^{\mathrm{th}}$ degree Legendre polynomial. We remark that this theorem can be extended to distributions as well. 
%
%%% Quadratures -- new header/section
\vspace{0.25cm}
\begin{center}\pbox{0.8\columnwidth}{}{linewidth=2mm,framearc=0.1,linecolor=lightblue,fillstyle=gradient,gradangle=0,gradbegin=white,gradend=whiteblue,gradmidpoint=1.0,framesep=1em}{\begin{center}Quadratures for the sphere\end{center}}\end{center}
\vspace{0.25cm}
Quadratures are at the heart of many methods for discretely sampling functions. These methods typically result from 
discretizing some type of integral representation, e.g., in the case of the functions on the sphere Eq.(\ref{eq:rep}). 

While one-dimensional quadratures are well understood, developing quadratures for the sphere is an active area of research. The difficulty in constructing quadratures for the sphere is related to its topology. A variety of quadratures for the sphere already exist, ranging from exact Cartesian product quadratures to approximate quadratures found by treating nodes as charged particles and minimizing their electrostatic potential energy. From the point of view of efficient function representation, especially of localized functions, many existing quadratures have serious drawbacks, ranging from clustering of nodes to poor conditioning of resulting matrices.

Since subspaces of spherical harmonics, $\HH_{N}$, are rotationally invariant it is natural to require rotational symmetry in a quadrature for the sphere. Because of the finite nature of the quadrature, only finite rotation groups can be considered. In \cite{AHR-BEY-2009}, a numerical method was presented to construct exact quadratures which are invariant under the icosahedral rotation group. These quadratures are exact for subspaces of spherical harmonics and are nearly perfectly efficient. The high efficiency of these quadratures, as compared to other more standard ones, arises because of their Gaussian nature. Moreover, these quadratures are quite uniform and have no clustering of nodes, like other spherical quadratures. For a more detailed discussion of the construction and properties of these quadratures, see Ref.~\cite{AHR-BEY-2009}. 

To visualize how well a point set covers the sphere we assign to each point a Gaussian density $\exp\left(-s^2/2\sigma^2\right)$, where $s$ is the arclength measured from the point and $\sigma^2=2/n\log\left(2\right)$ with $n$ the number of points. Figure~1 shows a coverage map of a symmeterized version of a 64 point grid regularly used for diffusion tensor imaging at UC Berkeley. The 64 points lie in the upper hemisphere. Another 64 points where added to the grid by reflecting the original 64 points through the origin. The displayed version thus has 128 points. Figure~2 shows a coverage map for a quadrature with 72 nodes (originally distributed over the whole sphere) taken from Ref.~\cite{AHR-BEY-2009}.
\begin{center}
  % first argument: eps-file
  % second argument: stretching-factor relative to Column-width (<1)
  % optional argument: rotation angle (0-360), default=0
  \myfig[0]{coverage_64_full_range.eps}{0.6}
  \mycaption{Coverage map for 64 measurement directions used at UC-Berkeley.}
\end{center}
%
\begin{center}
  % first argument: eps-file
  % second argument: stretching-factor relative to Column-width (<1)
  % optional argument: rotation angle (0-360), default=0
  \myfig[0]{coverage_72_full_range.eps}{0.6}
  \mycaption{Coverage map for quadrature with 72 nodes from Ref.~\cite{AHR-BEY-2009}.}
\end{center}
%
Figures 1 and 2 clearly show that the quadrature nodes are more uniformly distributed than the nodes used in diffusion tensor imaging at UC-Berkeley. Moreover, they are approximately half as many points for the quadrature, but the coverage is better. Thus, using the quadrature nodes as measurement directions for diffusion MRI may lead to reduced total measurement time while retaining the same or better resolution. This is currently under investigation.  

The quadratures from Ref.~\cite{AHR-BEY-2009} will now be used to develop a localized representation of functions on the sphere, ideally suited for reconstruction of HARDI signals.


%%%Local representations -- new header/section
\vspace{0.25cm}
\begin{center}\pbox{0.8\columnwidth}{}{linewidth=2mm,framearc=0.1,linecolor=lightblue,fillstyle=gradient,gradangle=0,gradbegin=white,gradend=whiteblue,gradmidpoint=1.0,framesep=1em}{\begin{center}Local representations\end{center}}\end{center}
\vspace{0.25cm}

Using the quadratures from Ref.~\cite{AHR-BEY-2009}, we construct an alternative representation for functions on invariant
subspaces of $L^{2}\left(\mathbb{S}^{2}\right)$, namely $\HH_{N}$, by discretizing Eq. (\ref{eq:rep})
%
\begin{equation}
  f\left(\boldsymbol{\omega}\right)=\sum_{j=1}^{M}K\left(\bomega\cdot\bomega_{j}\right)w_{j}f\left(\bomega_{j}\right),
  \label{eq:f-semi-disc}
\end{equation}
%
with $\bomega_{j}$ a quadrature point and $w_{j}$ the associated weight. If $f\in\HH_{N}$, then (\ref{eq:f-semi-disc}) provides
an exact reconstruction of the function $f$ from its values $f\left(\bomega_{1}\right),f\left(\bomega_{2}\right),\dots,f\left(\bomega_{M}\right)$.
The functions $\left\{ K\left(\bomega\cdot\bomega_{j}\right)w_{j}\right\} _{j=1}^{M}$
play a role similar to that of Lagrange interpolating polynomials
and, therefore, we may think of (\ref{eq:f-semi-disc}) as an analogue
of Lagrange interpolation on the sphere. Figure~3 shows a plot of one of the functions $K\left(\bomega\cdot\bomega_{j}\right)$ with the point $\bomega_{j}$ taken as the north pole, $\mathbf{e}_z$.
\begin{center}
  % first argument: eps-file
  % second argument: stretching-factor relative to Column-width (<1)
  % optional argument: rotation angle (0-360), default=0
  \myfig[0]{splot.eps}{0.3}
  \mycaption{The function $K\left(\bomega\cdot\mathbf{e}_z\right)$.}
\end{center}


%
%%%HARDI reconstruction -- new header/section
\vspace{0.25cm}
\begin{center}\pbox{0.8\columnwidth}{}{linewidth=2mm,framearc=0.1,linecolor=lightblue,fillstyle=gradient,gradangle=0,gradbegin=white,gradend=whiteblue,gradmidpoint=1.0,framesep=1em}{\begin{center}HARDI Reconstruction\end{center}}\end{center}
\vspace{0.25cm}
The diffusion weighted MR signal has the form
%
\begin{equation}
  s\left(\mathbf{q}\right) = s_0\int_{\mathbb{R}^3}p\left(\mathbf{r}\right)e^{-2\pi i \mathbf{q}\cdot\mathbf{r}}d^3r,
\end{equation}
%
where $p\left(\mathbf{r}\right)$ is the ensemble averaged probability distribution function. To reconstruct directional information, the radial projection of $s\left(\mathbf{q}\right)$, the so-called orientation distribution function (ODF), can be used and is defined by
%
\begin{equation}
  \psi\left(\mathbf{u}\right) = \int_0^{\infty} p\left(\mathbf{u}r\right) dr,\;\; \mathbf{u}\in\mathbb{S}^2.
\end{equation}
Because of the localized features found in $\psi\left(\mathbf{u}\right)$, the representation $\psi\left(\mathbf{u}\right) \approx \sum_{j=1}^M \psi_j K\left(\mathbf{u}\cdot\bomega_{j}\right)$ is attractive since the coefficients will be sparse, i.e., there will be only a few dominant coefficients corresponding to the peak directions of $\psi$. Tuch \cite{TUCH-2004} showed that the ODF can be approximated by the Funk-Radon transform of the diffusion signal $s$, i.e.,
%
\begin{equation}
  \psi\left(\mathbf{u}\right) \approx \mathcal{G}\left[s\right]\left(\mathbf{u}\right).
\end{equation}
%
Thus, using ideas similar to those found in \cite{L-C-D-H-2009}, we propose reconstructing the ODF $\psi$ from measurements of the diffusion signal $s\left(\bomega_{j}\right)$, $j=1,2,...J$ by construction the system of $J$ equations
%
\begin{equation}
  s\left(\bomega_{j}\right) \approx \sum_{i=1}^M \psi_i \mathcal{G}^{-1}\left[K\left(\cdot\bomega_{i}\right)\right]\left(\bomega_{j}\right), \;\;\;j=1,2,3,...J.
\end{equation}
%
We solve the resulting under-determined system for the $\psi_i$ using an $l_1$ penalized least-squares minimization technique. Note that $\mathcal{G}^{-1}\left[K\left(\cdot\bomega_{i}\right)\right]\left(\bomega_{j}\right)$ can be calculated explicitly using the Funk-Hecke theorem. The coefficients $\psi_i$ can then be used to determine dominant fiber directions. Robust methods for accomplishing this are currently being developed.
%%% Conclusions -- new header/section
\vspace{0.25cm}
\begin{center}\pbox{0.8\columnwidth}{}{linewidth=2mm,framearc=0.1,linecolor=lightblue,fillstyle=gradient,gradangle=0,gradbegin=white,gradend=whiteblue,gradmidpoint=1.0,framesep=1em}{\begin{center}Conclusions\end{center}}\end{center}
\vspace{0.25cm}

We introduced...

\vspace{0.25cm}
\emph{This research was partially supported by AFOSR grant FA9550-07-1-0135,
NSF grant DMS-0612358, DOE/ORNL grants 4000038129 and DE-FG02-03ER25583.}

%%% References
\bibliographystyle{plain}
\bibliography{poster}


\end{multicols}

\end{poster}

\end{document}

